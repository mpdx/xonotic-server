services:
  xonotic:
    build: ./xonotic
    container_name: xonotic-server
    restart: unless-stopped
    ports:
      - "26000:26000/udp"
    volumes:
      - xonotic-data:/opt/xonotic/data
      - ./maps:/opt/xonotic/data/data:ro
    environment:
      - SERVER_HOSTNAME=${SERVER_HOSTNAME:-My Xonotic Server}
      - RCON_PASSWORD=${RCON_PASSWORD:-changeme}
      - MAX_PLAYERS=${MAX_PLAYERS:-16}
      - GAME_PORT=${GAME_PORT:-26000}
      - MAP_SERVER_URL=${MAP_SERVER_URL:-http://localhost:8080/maps/}

  maps:
    image: nginx:alpine
    container_name: xonotic-maps
    restart: unless-stopped
    ports:
      - "8080:80"
    volumes:
      - ./maps:/usr/share/nginx/html/maps:ro
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro

volumes:
  xonotic-data:
